sequenceDiagram
    actor User as 用户
    participant FE as 前端应用
    participant BE as 后端服务
    participant STT as 语音识别服务
    participant LLM as 大语言模型
    participant TTS as 语音合成服务
    participant EM as EchoMimic引擎
    
    User->>FE: 语音输入
    FE->>BE: 发送语音数据
    
    %% 语音转文字阶段
    BE->>STT: 请求语音识别
    activate STT
    Note right of STT: 处理语音识别任务
    STT-->>BE: 返回识别的文本
    deactivate STT
    
    %% 大模型处理阶段
    BE->>LLM: 发送用户文本+对话历史
    activate LLM
    Note right of LLM: 生成回复内容
    LLM-->>BE: 返回AI回复文本
    deactivate LLM
    
    %% 文本转语音阶段
    BE->>TTS: 请求语音合成
    activate TTS
    Note right of TTS: 将文本转换为音频
    TTS-->>BE: 返回合成音频
    deactivate TTS
    
    %% EchoMimic处理阶段
    BE->>EM: 提交合成请求(音频+参考图像+姿态)
    activate EM
    Note right of EM: 1. 特征提取<br/>2. 扩散模型处理<br/>3. 视频渲染
    EM-->>BE: 返回数字人视频
    deactivate EM
    
    %% 返回最终结果
    BE-->>FE: 返回视频URL/数据
    FE-->>User: 展示数字人视频回复