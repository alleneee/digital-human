flowchart TD
    A[用户语音输入] --> B[语音转文字\nSTT服务]
    B -->|文本转换| C[文本输入]
    
    subgraph LLM处理
        C --> D[大模型处理\nLLM服务]
        D --> E[生成回复文本]
    end
    
    E --> F[文本转语音\nTTS服务]
    F -->|音频文件| G[音频回复]
    
    subgraph EchoMimic处理
        G --> H[音频特征提取]
        I[参考图像] --> J[图像特征提取]
        K[姿态数据] --> L[姿态特征提取]
        H & J & L --> M[特征融合]
        M --> N[扩散模型处理]
        N --> O[渲染生成]
    end
    
    O --> P[数字人视频输出]
    
    %% 数据流向说明
    classDef input fill:#d1f0ff,stroke:#0066cc
    classDef process fill:#fffacd,stroke:#d6b656
    classDef output fill:#d5e8d4,stroke:#82b366
    classDef llm fill:#ffd6cc,stroke:#b85450
    classDef echomimic fill:#e1d5e7,stroke:#9673a6
    
    class A,I,K input
    class B,D,F,H,J,L,M,N,O process
    class C,E,G,P output
    class LLM处理 llm
    class EchoMimic处理 echomimic