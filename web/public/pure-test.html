<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>纯HTML测试页面</title>
  <style>
    body {
      font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
      margin: 0;
      padding: 20px;
      background-color: #f5f7ff;
      color: #333;
    }
    
    .container {
      max-width: 800px;
      margin: 0 auto;
      background-color: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }
    
    h1 {
      color: #4a6bdf;
      text-align: center;
      margin-bottom: 20px;
    }
    
    .section {
      margin-bottom: 30px;
      padding: 15px;
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      background-color: #f9f9f9;
    }
    
    button {
      background-color: #4a6bdf;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 4px;
      cursor: pointer;
      margin: 5px 0;
      font-size: 14px;
    }
    
    button:hover {
      background-color: #3a56c5;
    }
    
    .result {
      margin-top: 10px;
      padding: 10px;
      background-color: #f0f0f0;
      border-radius: 4px;
      min-height: 20px;
    }
    
    .success {
      color: #4CAF50;
    }
    
    .error {
      color: #f44336;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>纯HTML测试页面</h1>
    
    <div class="section">
      <h2>基本页面测试</h2>
      <p>如果你能看到这个页面，说明服务器可以正确提供静态文件。</p>
      <p>页面加载时间: <span id="loadTime"></span></p>
    </div>
    
    <div class="section">
      <h2>DOM操作测试</h2>
      <p>点击按钮测试JavaScript DOM操作:</p>
      <button id="testDomBtn">测试DOM操作</button>
      <div id="domResult" class="result"></div>
    </div>
    
    <div class="section">
      <h2>API测试</h2>
      <p>测试与后端API的连接:</p>
      <button id="testApiBtn">测试API连接</button>
      <div id="apiResult" class="result"></div>
    </div>
    
    <div class="section">
      <h2>WebSocket测试</h2>
      <p>测试WebSocket连接:</p>
      <button id="connectWsBtn">连接WebSocket</button>
      <button id="disconnectWsBtn" disabled>断开WebSocket</button>
      <p>状态: <span id="wsStatus">未连接</span></p>
      <div id="wsResult" class="result"></div>
    </div>
  </div>

  <script>
    // 显示页面加载时间
    document.getElementById('loadTime').textContent = new Date().toLocaleString();
    
    // DOM操作测试
    document.getElementById('testDomBtn').addEventListener('click', function() {
      const result = document.getElementById('domResult');
      result.innerHTML = '';
      
      try {
        // 创建一些元素
        const div = document.createElement('div');
        div.textContent = '这是动态创建的元素';
        div.style.padding = '5px';
        div.style.backgroundColor = '#e8f4fd';
        div.style.marginBottom = '5px';
        
        // 添加到结果区域
        result.appendChild(div);
        
        // 创建一个计数器
        const counter = document.createElement('div');
        counter.innerHTML = '<span>计数: </span><span id="counter">0</span>';
        
        const incrementBtn = document.createElement('button');
        incrementBtn.textContent = '增加';
        incrementBtn.style.marginLeft = '10px';
        incrementBtn.onclick = function() {
          const counterSpan = document.getElementById('counter');
          const count = parseInt(counterSpan.textContent) + 1;
          counterSpan.textContent = count;
        };
        
        counter.appendChild(incrementBtn);
        result.appendChild(counter);
        
        // 添加成功消息
        const success = document.createElement('p');
        success.textContent = 'DOM操作测试成功!';
        success.className = 'success';
        result.appendChild(success);
      } catch (error) {
        const errorMsg = document.createElement('p');
        errorMsg.textContent = '错误: ' + error.message;
        errorMsg.className = 'error';
        result.appendChild(errorMsg);
      }
    });
    
    // API测试
    document.getElementById('testApiBtn').addEventListener('click', function() {
      const result = document.getElementById('apiResult');
      result.innerHTML = '<p>正在测试API连接...</p>';
      
      // 测试配置API
      fetch('http://localhost:8000/api/update_config', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          language: 'zh',
          voice: 'zh-CN-XiaoxiaoNeural',
          theme: 'light'
        })
      })
      .then(response => {
        if (!response.ok) {
          throw new Error('API请求失败: ' + response.status);
        }
        return response.json();
      })
      .then(data => {
        const success = document.createElement('p');
        success.textContent = 'API连接成功!';
        success.className = 'success';
        
        const details = document.createElement('pre');
        details.textContent = JSON.stringify(data, null, 2);
        
        result.innerHTML = '';
        result.appendChild(success);
        result.appendChild(details);
      })
      .catch(error => {
        const errorMsg = document.createElement('p');
        errorMsg.textContent = '错误: ' + error.message;
        errorMsg.className = 'error';
        result.innerHTML = '';
        result.appendChild(errorMsg);
      });
    });
    
    // WebSocket测试
    let ws = null;
    
    document.getElementById('connectWsBtn').addEventListener('click', function() {
      const status = document.getElementById('wsStatus');
      const result = document.getElementById('wsResult');
      const connectBtn = document.getElementById('connectWsBtn');
      const disconnectBtn = document.getElementById('disconnectWsBtn');
      
      result.innerHTML = '<p>正在连接WebSocket...</p>';
      status.textContent = '正在连接...';
      
      try {
        // 创建WebSocket连接
        ws = new WebSocket('ws://localhost:8000/ws');
        
        // 连接打开
        ws.onopen = function() {
          status.textContent = '已连接';
          status.className = 'success';
          
          const success = document.createElement('p');
          success.textContent = 'WebSocket连接成功!';
          success.className = 'success';
          
          result.innerHTML = '';
          result.appendChild(success);
          
          // 启用/禁用按钮
          connectBtn.disabled = true;
          disconnectBtn.disabled = false;
          
          // 发送一个测试消息
          ws.send(JSON.stringify({
            type: 'ping',
            data: { timestamp: Date.now() }
          }));
        };
        
        // 接收消息
        ws.onmessage = function(event) {
          const message = document.createElement('div');
          message.style.marginTop = '5px';
          message.style.padding = '5px';
          message.style.backgroundColor = '#e8f4fd';
          message.style.borderLeft = '4px solid #4a6bdf';
          
          try {
            const data = JSON.parse(event.data);
            message.innerHTML = '<strong>收到消息:</strong> <pre>' + JSON.stringify(data, null, 2) + '</pre>';
          } catch (e) {
            message.textContent = '收到消息: ' + event.data;
          }
          
          result.appendChild(message);
        };
        
        // 连接关闭
        ws.onclose = function() {
          status.textContent = '已断开';
          status.className = '';
          
          const closed = document.createElement('p');
          closed.textContent = 'WebSocket连接已关闭';
          result.appendChild(closed);
          
          // 启用/禁用按钮
          connectBtn.disabled = false;
          disconnectBtn.disabled = true;
          
          ws = null;
        };
        
        // 连接错误
        ws.onerror = function(error) {
          status.textContent = '连接错误';
          status.className = 'error';
          
          const errorMsg = document.createElement('p');
          errorMsg.textContent = 'WebSocket连接错误';
          errorMsg.className = 'error';
          result.appendChild(errorMsg);
          
          // 启用/禁用按钮
          connectBtn.disabled = false;
          disconnectBtn.disabled = true;
        };
      } catch (error) {
        status.textContent = '连接失败';
        status.className = 'error';
        
        const errorMsg = document.createElement('p');
        errorMsg.textContent = '错误: ' + error.message;
        errorMsg.className = 'error';
        result.innerHTML = '';
        result.appendChild(errorMsg);
        
        // 启用/禁用按钮
        connectBtn.disabled = false;
        disconnectBtn.disabled = true;
      }
    });
    
    document.getElementById('disconnectWsBtn').addEventListener('click', function() {
      if (ws) {
        ws.close();
      }
    });
  </script>
</body>
</html> 