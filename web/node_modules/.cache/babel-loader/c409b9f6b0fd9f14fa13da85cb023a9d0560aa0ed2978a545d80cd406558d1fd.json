{"ast":null,"code":"var _jsxFileName = \"/Users/niko/digital-human/frontend/src/components/ChatPanel/index.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { useWebSocket } from '../../contexts/WebsocketContext';\nimport './ChatPanel.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ChatPanel = () => {\n  _s();\n  const {\n    messages,\n    sendMessage,\n    isProcessing\n  } = useWebSocket();\n  const [inputText, setInputText] = useState('');\n  const messagesEndRef = useRef(null);\n\n  // 自动滚动到底部\n  const scrollToBottom = () => {\n    var _messagesEndRef$curre;\n    (_messagesEndRef$curre = messagesEndRef.current) === null || _messagesEndRef$curre === void 0 ? void 0 : _messagesEndRef$curre.scrollIntoView({\n      behavior: 'smooth'\n    });\n  };\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  // 处理消息发送\n  const handleSendMessage = e => {\n    e.preventDefault();\n    if (inputText.trim() && !isProcessing) {\n      sendMessage(inputText);\n      setInputText('');\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"chat-panel\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"messages-container\",\n      children: [messages.map((msg, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `message ${msg.role === 'user' ? 'user-message' : 'assistant-message'}`,\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"message-content\",\n          children: msg.content\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 36,\n          columnNumber: 13\n        }, this)\n      }, index, false, {\n        fileName: _jsxFileName,\n        lineNumber: 32,\n        columnNumber: 11\n      }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: messagesEndRef\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 39,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 30,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      className: \"message-input-form\",\n      onSubmit: handleSendMessage,\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        value: inputText,\n        onChange: e => setInputText(e.target.value),\n        placeholder: \"\\u8F93\\u5165\\u6D88\\u606F...\",\n        disabled: isProcessing\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 43,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        disabled: !inputText.trim() || isProcessing,\n        children: \"\\u53D1\\u9001\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 50,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 42,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 29,\n    columnNumber: 5\n  }, this);\n};\n_s(ChatPanel, \"C5Ovr6LvY+Dht0XwH0fJDU5EAU0=\", false, function () {\n  return [useWebSocket];\n});\n_c = ChatPanel;\nexport default ChatPanel;\nvar _c;\n$RefreshReg$(_c, \"ChatPanel\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useWebSocket","jsxDEV","_jsxDEV","ChatPanel","_s","messages","sendMessage","isProcessing","inputText","setInputText","messagesEndRef","scrollToBottom","_messagesEndRef$curre","current","scrollIntoView","behavior","handleSendMessage","e","preventDefault","trim","className","children","map","msg","index","role","content","fileName","_jsxFileName","lineNumber","columnNumber","ref","onSubmit","type","value","onChange","target","placeholder","disabled","_c","$RefreshReg$"],"sources":["/Users/niko/digital-human/frontend/src/components/ChatPanel/index.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { useWebSocket } from '../../contexts/WebsocketContext';\nimport './ChatPanel.css';\n\nconst ChatPanel = () => {\n  const { messages, sendMessage, isProcessing } = useWebSocket();\n  const [inputText, setInputText] = useState('');\n  const messagesEndRef = useRef(null);\n  \n  // 自动滚动到底部\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n  \n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n  \n  // 处理消息发送\n  const handleSendMessage = (e) => {\n    e.preventDefault();\n    if (inputText.trim() && !isProcessing) {\n      sendMessage(inputText);\n      setInputText('');\n    }\n  };\n  \n  return (\n    <div className=\"chat-panel\">\n      <div className=\"messages-container\">\n        {messages.map((msg, index) => (\n          <div \n            key={index} \n            className={`message ${msg.role === 'user' ? 'user-message' : 'assistant-message'}`}\n          >\n            <div className=\"message-content\">{msg.content}</div>\n          </div>\n        ))}\n        <div ref={messagesEndRef} />\n      </div>\n      \n      <form className=\"message-input-form\" onSubmit={handleSendMessage}>\n        <input\n          type=\"text\"\n          value={inputText}\n          onChange={(e) => setInputText(e.target.value)}\n          placeholder=\"输入消息...\"\n          disabled={isProcessing}\n        />\n        <button \n          type=\"submit\"\n          disabled={!inputText.trim() || isProcessing}\n        >\n          发送\n        </button>\n      </form>\n    </div>\n  );\n};\n\nexport default ChatPanel;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}